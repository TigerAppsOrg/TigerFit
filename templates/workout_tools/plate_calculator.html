<div class="modal-content">
    <div class="modal-header modal-header--sticky">
        <div class="container-fluid justify-content-center">
            <div class="row">
                <h2 class="modal-title col-12 text-center py-1" id="exampleModalLabel" style="font-weight: bolder">
                    Plate Calculator
                </h2>

                <button type="button" id="close-modal-button" class="col-1 btn btn-danger btn-red m-3" data-bs-dismiss="modal" style="
                    position: absolute;
                    right: 0;
                    top: 0;
                    width: 30px;
                    height: 30px;
                  ">
                    <i class="fa fa-times" style="position: absolute; right: 7.5px; top: 6px"></i>
                </button>
            </div>


        </div>
    </div>

    <div class="modal-body">
        <div class="row justify-content-center">
            <input type="number" id="plate-calculator-total-input" placeholder="Total Weight"><br>

            <input type="number" id="plate-calculator-bar-input" placeholder="Bar Weight"><br>

            <button id="plate-calculator-button">Calculate</button>

            <div id="plate-calculator-result"></div>

            <script>
                const PLATE_WEIGHTS = [45, 25, 10, 5, 2.5, 1.25];

                // Calculates how many of each plate are needed
                function calculatePlates(totalWeight, barWeight) {
                    const plateCounts = [0, 0, 0, 0, 0, 0];


                    let weightRemaining = (totalWeight - barWeight) / 2;
                    for (let i = 0; i < PLATE_WEIGHTS.length; i++) {
                        while (weightRemaining >= PLATE_WEIGHTS[i]) {
                            weightRemaining -= PLATE_WEIGHTS[i];
                            plateCounts[i]++;
                        }
                    }

                    return [plateCounts, weightRemaining * 2];
                }


                $(document).on('click', '#plate-calculator-button', function () {
                    const totalWeight = parseFloat($('#plate-calculator-total-input').val());
                    const barWeight = parseFloat($('#plate-calculator-bar-input').val());

                    // Ensures that the weight added to bar is a
                    // multiple of 2.5
                    // And totalWeight > barWeight
                    if (isNaN(totalWeight) || isNaN(barWeight) || (totalWeight - barWeight) % 2.5 !== 0 || totalWeight <= barWeight) {
                        let resultHTML = 'Cannot calculate weight';
                        $('#plate-calculator-result').html(resultHTML);
                        return
                    }

                    const [plateCounts, weightRemaining] = calculatePlates(totalWeight, barWeight);

                    // Determines result HTML
                    let resultHTML = '';
                    for (let i = 0; i < plateCounts.length; i++) {
                        if (plateCounts[i] > 0) {
                            resultHTML += plateCounts[i] + ' x ' + PLATE_WEIGHTS[i] + ' lbs<br>';
                        }
                    }

                    $('#plate-calculator-result').html(resultHTML);
                });
            </script>

        </div>

    </div>
</div>
